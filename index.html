<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xuan&AnanğŸ±</title>
    <link rel="icon" href="åƒç´ çˆ±å¿ƒ.png" type="image/png">
    <style>
        /* ================= CSS æ ·å¼æ•´åˆ ================= */
        
        /* 1. åŸºç¡€å¸ƒå±€ä¸èƒŒæ™¯ */
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            overflow: hidden;
            background: radial-gradient(circle at center, #1e4572 0%, #0f1c3f 100%);
            display: flex; justify-content: center; align-items: center;
            background-color: #0a0a0a;
        }

        /* 2. åŠ è½½åŠ¨ç”»é®ç½© (Loader) */
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #0f1c3f; display: flex; flex-direction: column;
            justify-content: center; align-items: center; z-index: 999;
            transition: opacity 0.8s ease;
        }

        /* åƒç´ æ–¹å—è·³åŠ¨åŠ¨ç”» */
        .pixel-spinner {
            width: 20px; height: 20px; background: #adff2f;
            box-shadow: 25px 0 #adff2f, -25px 0 #adff2f;
            animation: move 1s infinite;
        }

        @keyframes move {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .loading-text {
            margin-top: 30px; color: white;
            font-family: 'Courier New', monospace; font-size: 14px;
            letter-spacing: 2px;
        }

        /* 3. è§†é¢‘å®¹å™¨ä¸æ¼‚æµ®åŠ¨ç”» */
        .scene-container {
            position: relative; z-index: 2; border-radius: 12px;
            box-shadow: 0 0 60px rgba(0, 150, 255, 0.3);
            animation: floating 5s ease-in-out infinite;
            opacity: 0; /* é…åˆ JS åŠ è½½å®Œåæ·¡å…¥ */
            transition: opacity 1.5s ease;
        }
        
        /* åŠ è½½å®Œæˆåçš„ç±»å */
        .scene-container.loaded { opacity: 1; }

        .pixel-video {
            display: block; max-width: 85vw; max-height: 85vh;
            border-radius: 12px;
            /* ä¿æŒåƒç´ é£æ¸…æ™° */
            image-rendering: pixelated;
            image-rendering: crisp-edges;
            object-fit: contain;
            border: 2px solid rgba(255, 255, 255, 0.1);
            background-color: #000;
        }

        @keyframes floating {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        /* 4. Canvas ç‰¹æ•ˆå±‚ */
        #particleCanvas {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 3; pointer-events: none; /* ç¡®ä¿é¼ æ ‡å¯ä»¥ç‚¹åˆ°æŒ‰é’® */
        }

        /* 5. éŸ³ä¹æŒ‰é’®æ ·å¼ */
        .music-btn {
            position: fixed; bottom: 30px; right: 30px; z-index: 10;
            padding: 12px 24px; background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 30px; color: white; cursor: pointer;
            font-family: 'Courier New', monospace; font-size: 14px;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            outline: none;
        }

        .music-btn:hover { background: rgba(255, 255, 255, 0.25); transform: scale(1.05); }
        .music-btn.active { border-color: #adff2f; color: #adff2f; box-shadow: 0 0 15px rgba(173, 255, 47, 0.3); }

    </style>
</head>
<body>

    <div id="loader">
        <div class="pixel-spinner"></div>
        <div class="loading-text">LOADING PIXELS...</div>
    </div>

    <audio id="bgm" loop>
        <source src="bgm.mp3" type="audio/mpeg">
    </audio>

    <canvas id="particleCanvas"></canvas>

    <div class="scene-container" id="container">
        <video id="mainVideo" autoplay loop muted playsinline poster="cute.jpg" class="pixel-video">
            <source src="cute.mp4" type="video/mp4">
        </video>
    </div>

    <button id="musicControl" class="music-btn">Music: OFF</button>

    <script>
        /* ================= JavaScript é€»è¾‘æ•´åˆ ================= */

        const video = document.getElementById('mainVideo');
        const loader = document.getElementById('loader');
        const container = document.getElementById('container');
        const canvas = document.getElementById('particleCanvas');
        const ctx = canvas.getContext('2d');
        const btn = document.getElementById('musicControl');
        const bgm = document.getElementById('bgm');

        // 1. è§†é¢‘åŠ è½½é€»è¾‘
        // å½“è§†é¢‘åŠ è½½åˆ°è¶³å¤Ÿæ’­æ”¾æ—¶éšè— Loading
        const handleLoaded = () => {
            loader.style.opacity = '0';
            setTimeout(() => {
                loader.style.display = 'none';
                container.classList.add('loaded');
            }, 800);
        };

        if (video.readyState >= 3) {
            handleLoaded();
        } else {
            video.addEventListener('canplaythrough', handleLoaded);
        }

        // 2. ç²’å­ç‰¹æ•ˆé€»è¾‘
        let particles = [];
        const resize = () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        };
        window.addEventListener('resize', resize);
        resize();

        class Particle {
            constructor() { this.init(); }
            init() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.type = Math.random() > 0.6 ? 1 : 0; // 0:æ˜Ÿæ˜Ÿ, 1:è¤ç«è™«
                this.size = this.type === 0 ? Math.random() * 1.5 : Math.random() * 3 + 1;
                this.speedX = (Math.random() - 0.5) * 0.4;
                this.speedY = (Math.random() - 0.5) * 0.4;
                this.alpha = Math.random();
                this.fade = Math.random() * 0.02 + 0.005;
            }
            update() {
                this.x += this.speedX; this.y += this.speedY;
                this.alpha += this.fade;
                if (this.alpha > 1 || this.alpha < 0) this.fade *= -1;
                if (this.x < 0 || this.x > canvas.width || this.y < 0 || this.y > canvas.height) this.init();
            }
            draw() {
                ctx.save();
                ctx.globalAlpha = this.alpha;
                ctx.fillStyle = this.type === 0 ? "#ffffff" : "#adff2f";
                if (this.type === 1) { ctx.shadowBlur = 10; ctx.shadowColor = "#adff2f"; }
                ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); ctx.fill();
                ctx.restore();
            }
        }

        for (let i = 0; i < 70; i++) particles.push(new Particle());

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach(p => { p.update(); p.draw(); });
            requestAnimationFrame(animate);
        }
        animate();

        // 3. éŸ³ä¹äº¤äº’é€»è¾‘
        bgm.volume = 0.5;
        btn.onclick = () => {
            if (bgm.paused) {
                bgm.play().then(() => {
                    btn.innerText = "Music: ON";
                    btn.classList.add('active');
                }).catch(e => {
                    console.log("éœ€è¦ç”¨æˆ·äº¤äº’æ‰èƒ½æ’­æ”¾éŸ³ä¹");
                });
            } else {
                bgm.pause();
                btn.innerText = "Music: OFF";
                btn.classList.remove('active');
            }
        };

        // å®¹é”™ï¼šå¦‚æœè§†é¢‘5ç§’è¿˜æ²¡åŠ è½½å®Œï¼Œå¼ºåˆ¶è¿›å…¥é¡µé¢
        setTimeout(() => {
            if (loader.style.display !== 'none') handleLoaded();
        }, 5000);

    </script>
</body>
</html>
